/*
ChocolateChip-UI
ChUI.ios.js
Copyright 2013 Sourcebits www.sourcebits.com
License: BSD
Version: 3.0
*/
(function($){'use strict';$.extend($,{eventStart:null,eventEnd:null,eventMove:null,eventCancel:null,gestureLength:30});$.extend($,{UuidSeed:0,Uuid:function(){$.UuidSeed++;var a=Date.now()+$.UuidSeed;return a.toString(36)},array:Array.prototype,UITrackHashNavigation:function(a,b){a=a||true;$.UISetHashOnUrl($.UINavigationHistory[$.UINavigationHistory.length-1],b)},UISetHashOnUrl:function(a,b){b=b||'#/';var c;if(/^#/.test(a)){c=b+(a.split('#')[1])}else{c=b+a}if($.isAndroid){if(/#/.test(a)){a=a.split('#')[1]}if(/\//.test(a)){a=a.split('/')[1]}window.location.hash='#/'+a}else{window.history.replaceState('Object','Title',c)}},UIGoBackToArticle:function(b){var c=$.UINavigationHistory.indexOf(b);var d=$('article.current');var e=$(b);var f=$.UINavigationHistory.slice(c+1);if(f.length){f.forEach(function(a){$(a).removeClass('previous').addClass('next');$(a).prev().removeClass('previous').addClass('next')})}e.removeClass('previous').addClass('current');e.prev().removeClass('previous').addClass('current');d.removeClass('current').addClass('next');d.prev().removeClass('current').addClass('next');$.UINavigationHistory=$.UINavigationHistory.splice(c,1)},UIGoBack:function(){var a=$.UINavigationHistory.length;var b=$('article.current');var c=$($.UINavigationHistory[a-2]);c.removeClass('previous').addClass('current');c.prev().removeClass('previous').addClass('current');b.removeClass('current').addClass('next');b.prev().removeClass('current').addClass('next');$.UISetHashOnUrl($.UINavigationHistory[a-2]);if($.UINavigationHistory[a-1]!==$.firstArticle[0].id){$.UINavigationHistory.pop()}},isNavigating:false,UIGoToArticle:function(a){if($.isNavigating)return;$.isNavigating=true;var b=$('article.current');a=$(a);var c=b.prev();var d=a.prev();b.removeClass('current').addClass('previous');a.removeClass('next').addClass('current');c.removeClass('current').addClass('previous');d.removeClass('next').addClass('current');$.UISetHashOnUrl(a[0].id);setTimeout(function(){$.isNavigating=false},500)},UIDeletable:function(d){if(!d||!d.list||!d instanceof Array){return}var e=$(d.list);var f=d.editLabel||'Edit';var g=d.doneLabel||'Done';var h=d.deleteLabel||'Delete';var i=d.placement||'right';var j=d.callback||$.noop;var k;var l;var m;if($.isWin)h='';var n=function(b){var c;if($.isiOS){c='100px'}else if($.isAndroid){c='140px'}$(function(){$.body.on('singletap','.edit',function(){var a=this;setTimeout(function(){a.classList.remove('edit');a.classList.add('done');$(a).text(g);$(e).addClass('showIndicators')})});$.body.on('singletap','.done',function(){var a=this;setTimeout(function(){a.classList.remove('done');a.classList.add('edit');$(a).text(f);$(e).removeClass('showIndicators');$(e).find('li').removeClass('selected')})});$.body.on('singletap','.deletion-indicator',function(){if($(this).closest('li').hasClass('selected').length){$(this).closest('li').removeClass('selected');return}else{$(this).closest('li').addClass('selected')}});if($.isiOS){$(e).on('swipe','li',function(){if(this.classList.contains('selected')){this.classList.remove('selected')}$(this).removeClass('selected')})}$(e).on('singletap','.delete',function(){var a=this;$(this).siblings().css({'-webkit-transform':'translate3d(-1000%,0,0)','-webkit-transition':'all 1s ease-out'});setTimeout(function(){b.call(b,a);$(a).parent().remove()},500)})})};if(e[0].classList.contains('deletable'))return;k=$.concat('<a href="javascript:void(null)" class="button delete">',h,'</a>');l=$.concat('<a href="javascript:void(null)" class="button edit">',f,'</a>');m='<span class="deletion-indicator"></span>';if(i==='left'){e.ancestor('article').prev().prepend(l)}else{e.ancestor('article').prev().append(l);e.ancestor('article').prev().find('h1').addClass('buttonOnRight');e.ancestor('article').prev().find('.edit').addClass('align-flush')}e.find('li').prepend(m);e.find('li').append(k);var o=$('li').eq(1)[0].clientHeight;$('li').find('.delete').each(function(a){if(!$.isWin)$(a).css({height:o+'px'})});n(j);e.addClass('deletable');return e},UIPaging:function(){var b=$('.segmented.paging').closest('nav').next();if($('.segmented.paging').hasClass('horizontal')[0]){b.addClass('horizontal')}else if($('.segmented.paging').hasClass('vertical')[0]){b.addClass('vertical')}b.first().addClass('current');b.first().siblings().addClass('next');var c=b.children().length;$('.segmented.paging').on($.eventStart,'.button:first-of-type',function(){var a;a=$('section.current');if(a.index()===0)return;a.removeClass('current').addClass('next');a.prev().removeClass('previous').addClass('current')});$('.segmented.paging').on($.eventStart,'.button:last-of-type',function(){var a;if(this.classList.contains('disabled'))return;a=$('section.current');if(a.index()===c-1)return;a.removeClass('current').addClass('previous');a.next().removeClass('next').addClass('current')})},UISlideout:function(b){$('article').removeClass('next');$('article').removeClass('current');$('article').prev().removeClass('next');$('article').prev().removeClass('current');b=b||'left';var c=$.make("<a class='button slide-out-button' href='javascript:void(null)'></a>");var d='<div class="slide-out"><section></section></div>';$.body.append(d);$.body.addClass('slide-out-app');$('article:first-of-type').addClass('show');$('article:first-of-type').prev().addClass('show');$('#global-nav').append(c);$('.slide-out-button').on($.eventStart,function(){$('.slide-out').toggleClass('open')});$('.slide-out').on('singletap','li',function(){var a='#'+$(this).attr('data-show-article');$('.slide-out').removeClass('open');$('article').removeClass('show');$('article').prev().removeClass('show');$(a).addClass('show');$(a).prev().addClass('show')})}});$.fn.extend({UISwitch:function(){var c=false;this.each(function(b){b.setAttribute('role','checkbox');if($(b).data('ui-setup')===true)return;if(!b.querySelector('input')){b.insertAdjacentHTML('afterBegin','<input type="checkbox">')}if(b.classList.contains('on')){b.querySelector('input').setAttribute('checked','checked')}if(b.querySelector('em'))c=true;if(!c){b.insertAdjacentHTML('afterBegin','<em></em>')}$(b).on('singletap',function(){var a=b.querySelector('input');if(b.classList.contains('on')){b.classList.remove('on');b.removeAttribute('aria-checked');a.removeAttribute('checked')}else{b.classList.add('on');a.setAttribute('checked','checked');b.setAttribute('aria-checked',true)}});$(b).data('ui-setup',true)})},UISegmented:function(c){if(this.hasClass('paging')[0])return;var d=(c&&c.callback)?c.callback:$.noop;var f;if(c&&c.selected)f=c.selected;if(c&&c.callback){d=c.callback}this.find('a').each(function(a,b){$(a).find('a').attr('role','radio');if(f===0&&b===0){a.setAttribute('aria-checked','true');a.classList.add('selected')}if(b===f){a.setAttribute('aria-checked','true');a.classList.add('selected')}});if(!f){if(!this.find('.selected')[0]){this.children().eq(0).addClass('selected')}}this.on('singletap','.button',function(e){var a=$(this);if(this.parentNode.classList.contains('paging'))return;a.siblings('a').removeClass('selected');a.siblings('a').removeAttr('aria-checked');a.addClass('selected');a.attr('aria-checked',true);d.call(this,e)})},UIPanelToggle:function(b,c){var d;var e=0;if(this.children().hasClass('selected')[0]){e=this.children().hasClass('selected').index()}if(b instanceof Array){d=b.children('div')}else if(typeof b==='string'){d=$(b).children('div')}d.eq(e).siblings().css({display:'none'});if(c)c.apply(this,arguments);this.on($.eventEnd,'a',function(){d.eq($(this).index()).css({display:'block'}).siblings().css('display','none')});this.on('singletap','.button',function(){var a=$(this);if(this.parentNode.classList.contains('paging'))return;a.siblings('a').removeClass('selected');a.siblings('a').removeAttr('aria-checked');a.addClass('selected');a.attr('aria-checked',true)})},UISelectList:function(c){var d=(c&&c.name)?c.name:$.Uuid();var e=this[0];if(e&&!$(e).hasClass('select')){this.addClass('select')}if(!e)return[];e.classList.add('select');$(e).find('li').each(function(a,b){a.setAttribute('role','radio');if(c&&c.selected===b){a.setAttribute('aria-checked','true');a.classList.add('selected');if(!$(a).find('input')[0]){$(a).append('<input type="radio" checked="checked" name="'+d+'">')}else{$(a).find('input').attr('checked','checked')}}else{if(!$(a).find('input')[0]){$(a).append('<input type="radio" name="'+d+'">')}}});$(e).on('singletap','li',function(){var a=this;$(a).siblings('li').removeClass('selected');$(a).siblings('li').removeAttr('aria-checked');$(a).siblings('li').find('input').removeAttr('checked');$(a).addClass('selected');a.setAttribute('aria-checked',true);$(a).find('input').attr('checked','checked');if(c&&c.callback){c.callback.apply(this,arguments)}})},UIStepper:function(e){if(!e)return[];if(!e.start)return[];if(!e.end)return[];var f=this[0];var g=e.start;var h=e.end;var i=e.defaultValue?e.defaultValue:e.start;var j='+';var k='-';if($.isWin){j='';k=''}var l='<a href="javascript:void(null)" class="button decrease">'+k+'</a>';var m='<label>'+i+'</label><input type="text" value="'+i+'">';var n='<a href="javascript:void(null)" class="button increase">'+j+'</a>';$(f).append(l+m+n);$(f).data('ui-value',{start:g,end:h});var o=function(){var a=$(f).find('input').val();var b=$(f).data('ui-value');var c=b.start;var d;if(a<=c){$(this).addClass('disabled')}else{d=Number(a)-1;$(f).find('.button:last-of-type').removeClass('disabled');$(f).find('label').text(d);$(f).find('input').val(d);if(a===c){$(this).addClass('disabled')}}};var p=function(){var a=$(f).find('input').val();var b=$(f).data('ui-value');var c=b.end;var d;if(a>=c){$(this).addClass('disabled')}else{d=Number(a)+1;$(f).find('.button:first-of-type').removeClass('disabled');$(f).find('label').text(d);$(f).find('input').val(d);if(a===c){$(this).addClass('disabled')}}};[f].find('.button:first-of-type').on('singletap',function(){o.call(this,f)});[f].find('.button:last-of-type').on('singletap',function(){p.call(this,f)})},UIBusy:function(b){b=b||{};var c=this;var d=b.color||'#000';var e=b.size||'80px';var f=(b&&b.position==='right')?'align-flush':null;var g=b.duration||'1s';var h;var i=function(){var a={'-webkit-animation-duration':g};h=$.make('<span class="busy"></span>');$(h).css({'background-color':d,'height':e,'width':e});$(h).css(a);$(h).attr('role','progressbar');if(f)$(h).addClass(f);c.append(h);return this};var j=function(){var a={'-webkit-animation-duration':g};h=$.make('<div class="busy"><div></div><div></div></div>');$(h).css({'height':e,'width':e,"background-image":'url('+'"data:image/svg+xml;utf8,<svg xmlns:svg='+"'http://www.w3.org/2000/svg' xmlns='http://www.w3.org/2000/svg' version='1.1' x='0px' y='0px' width='400px' height='400px' viewBox='0 0 400 400' enable-background='new 0 0 400 400' xml:space='preserve'><circle fill='none' stroke='"+d+"' stroke-width='20' stroke-miterlimit='10' cx='199' cy='199' r='174'/>"+'</svg>"'+')'});$(h).css(a);$(h).attr('role','progressbar');$(h).innerHTML="<div></div><div></div>";if(f)$(h).addClass('align-'+f);c.append(h);return this};var k=function(){h=$.make('<progress class="busy"></progress>');$(h).css({'color':d});$(h).attr('role','progressbar');$(h).addClass('win-ring');if(f)$(h).addClass('align-'+f);c.append(h);return this};if($.isiOS){i(b)}else if($.isAndroid){j(b)}else if($.isWin){k(b)}},UICenter:function(){if(!this[0])return;var a=$(this);var b=a.parent();var c;if(a.css('position')!=='absolute')c='relative';else c='absolute';var d,width,parentHeight,parentWidth;if(c==='absolute'){d=a[0].clientHeight;width=a[0].clientWidth;parentHeight=b[0].clientHeight;parentWidth=b[0].clientWidth}else{d=parseInt(a.css('height'),10);width=parseInt(a.css('width'),10);parentHeight=parseInt(b.css('height'),10);parentWidth=parseInt(b.css('width'),10)}var e,tmpLeft;if(b[0].nodeName==='body'){e=((window.innerHeight/2)+window.pageYOffset)-d/2+'px';tmpLeft=((window.innerWidth/2)-(width/2)+'px')}else{e=(parentHeight/2)-(d/2)+'px';tmpLeft=(parentWidth/2)-(width/2)+'px'}if(c!=='absolute')tmpLeft=0;a.css({left:tmpLeft,top:e})},UIBlock:function(a){a=a?" style='opacity:"+a+"'":" style='opacity: .5;'";$(this).before("<div class='mask'"+a+"></div>");$('article.current').attr('aria-hidden',true);return this},UIUnblock:function(){$('.mask').remove();$('article.current').removeAttr('aria-hidden');return this},UIPopupClose:function(){if(!this[0].classList.contains('popup'))return;$(this).UIUnblock();$(this).remove()},UIPopover:function(h){if(!h)return[];var i=$(this);var j;if(this[0].id){j=this[0].id}else{j=$.Uuid();i.attr('id',j)}var k=h.id?h.id:$.Uuid();var l=h.title?('<header><h1>'+h.title+'</h1></header>'):'';var m=h.callback?h.callback:$.noop;var n='<div class="popover" id="'+k+'">'+l+'<section></section></div>';var o=function(a){var b=$(a).offset();var c=b.left;var d;var e;var f=$('.popover');var g=f.offset();d=g.left;e=b.bottom;if((f.width()+b.left)>window.innerWidth){f.css({'left':((window.innerWidth-f.width())-20)+'px','top':(b.bottom+20)+'px'})}else{f.css({'left':c+'px','top':(e+20)+'px'})}};$(this).on($.eventStart,function(){var a=this;$.body.append(n);$('.popover').UIBlock('.25');var b='singletap';if($.isWin&&$.isDesktop){b=$.eventStart+' singletap '+$.eventEnd}$('.mask').on(b,function(e){e.preventDefault();e.stopPropagation()});$('.popover').data('triggerEl',j);if($.isWin){o(a);$('.popover').addClass('open')}else{$('.popover').addClass('open');setTimeout(function(){o(a)})}m.call(m,a)})}});$.extend($,{UICreateSwitch:function(a){var b=a?a.id:$.Uuid();var c=a&&a.name?(' name="'+a.name+'"'):'';var d=a&&a.value?(' value="'+a.value+'"'):'';var e=(a&&a.state==='on')?(' '+a.state):'';var f=(a&&a.state==='on')?' checked="checked"':'';var g=$.concat('<span class="switch',e,'" id="',b,'"><em></em>','<input type="checkbox"',c,f,d,'></span>');return $.make(g)},UICreateSegmented:function(c){var d=(c&&c.className)?c.className:'';var e=(c&&c.labels)?c.labels:[];var f=(c&&c.selected)?c.selected:0;var g=['<div class="segmented'];if(d)g.push(' '+d);g.push('">');e.each(function(a,b){g.push('<a role="radio" class="button');if(f===b){g.push(' selected" aria-checked="true"')}else{g.push('"')}g.push('>');g.push(a);g.push('</a>')});g.push('</div>');return g.join('')},UIPopup:function(a){if(!a)return;var b=a.id||$.Uuid();var c=a.title?'<header><h1>'+a.title+'</h1></header>':'';var d=a.message?'<p role="note">'+a.message+'</p>':'';var f=a.cancelButton?'<a href="javascript:void(null)" class="button cancel" role="button">'+a.cancelButton+'</a>':'';var g=a.continueButton?'<a href="javascript:void(null)" class="button continue" role="button">'+a.continueButton+'</a>':'';var h=a.callback||$.noop;var i=a.empty?' style="padding: 40px 0;" ':'';var j,panelClose;if(a.empty){j='';panelClose=''}else{j='<div class="panel">';panelClose='</div>'}var k='<div class="popup closed" role="alertdialog" id="'+b+'"'+i+'>'+j+c+d+'<footer>'+f+g+'</footer>'+panelClose+'</div>';$.body.append(k);if(h&&g){$('.popup').find('.continue').on($.eventStart,function(){$('.popup').UIPopupClose();h.call(h)})}$.UICenterPopup();setTimeout(function(){$.body.find('.popup').removeClass('closed')},200);$.body.find('.popup').UIBlock('0.5');var l=$.eventStart+' singletap '+$.eventEnd;$('.mask').on(l,function(e){e.stopPropagation()})},UICenterPopup:function(){var a=$('.popup');if(!a[0])return;var b=((window.innerHeight/2)+window.pageYOffset)-(a[0].clientHeight/2)+'px';var c;if(window.innerWidth===320){c='10px'}else{c=Math.floor((window.innerWidth-318)/2)+'px'}if($.isWin){a.css({top:b})}else{a.css({left:c,top:b})}},UIAlignPopover:function(){var a=$('.popover');if(!a.length)return;var b=a.data('triggerEl');var c=$('#'+b).offset();var d=c.left;if(($(a).width()+c.left)>window.innerWidth){a.css({'left':((window.innerWidth-$(a).width())-20)+'px'})}else{a.css({'left':d+'px'})}},UIPopoverClose:function(){$.body.UIUnblock();$('.popover').css('visibility','hidden');setTimeout(function(){$('.popover').remove()},10)},UITabbar:function(c){if(!c)return;$.body.addClass('hasTabBar');var d=c.id||$.Uuid();var e=c.selected||'';var f='<div class="tabbar" id="'+d+'">';var g=$.isiOS?'<span class="icon"></span>':'';for(var i=0;i<c.tabs;i++){f+='<a class="button '+c.icons[i];if(e===i+1){f+=' selected'}f+='">'+g+'<label>'+c.labels[i]+'</label></a>'}f+='</div>';$.body.append(f);$('nav').removeClass('current').addClass('next');$('nav').eq(e).removeClass('next').addClass('current');$('article').removeClass('current').addClass('next');$('article').eq(e-1).removeClass('next').addClass('current');console.dir($('article').eq(e));$.body.find('.tabbar').on('singletap','.button',function(){var a=this;var b;a.classList.add('selected');$(this).siblings('a').removeClass('selected');b=$(this).index();$('.current').removeClass('current').addClass('next');$('article').eq(b).removeClass('next').addClass('current');$('nav').eq(b+1).removeClass('next').addClass('current')})},UISheet:function(a){var b=$.Uuid();var c='';var d='';if(a){b=a.id?a.id:b;c=a.listClass?' '+a.listClass:'';d=' style="background-color:'+a.background+';" '||''}var e='<div id="'+b+'" class="sheet'+c+'"><div class="handle"></div><section class="scroller-vertical"></section></div>';$.body.append(e);$('.sheet .handle').on($.eventStart,function(){$.UIHideSheet()})},UIShowSheet:function(){$('article.current').addClass('blurred');if($.isAndroid||$.isChrome){$('.sheet').css('display','block');setTimeout(function(){$('.sheet').addClass('opened')},20)}else{$('.sheet').addClass('opened')}},UIHideSheet:function(){$('.sheet').removeClass('opened');$('article.current').addClass('removeBlurSlow');setTimeout(function(){$('article.current').removeClass('blurred');$('article.current').removeClass('removeBlurSlow')},500)},UIDesktopCompat:function(){if($.isDesktop&&$.isSafari){$.body.addClass('isiOS').addClass('isDesktopSafari')}else if($.isDesktop&&$.isChrome){$.body.addClass('isAndroid').addClass('isDesktopChrome')}}});$(function(){if(window.navigator.msPointerEnabled){$.eventStart='MSPointerDown';$.eventEnd='MSPointerUp';$.eventMove='MSPointerMove';$.eventCancel='MSPointerCancel'}else if('ontouchstart'in window){$.eventStart='touchstart';$.eventEnd='touchend';$.eventMove='touchmove';$.eventCancel='touchcancel'}else{$.eventStart='mousedown';$.eventEnd='click';$.eventMove='mousemove';$.eventCancel='mouseout'}$.body=$('body');$.firstArticle=$('article').eq(0);if((/android/img.test(navigator.userAgent))&&(/webkit/img.test(navigator.userAgent))&&(!/Chrome/img.test(navigator.userAgent))){document.body.classList.add('isNativeAndroidBrowser')}$('nav').on($.eventStart,function(e){e.preventDefault()});$.extend($,{UINavigationHistory:["#"+$('article').eq(0).attr('id')],});$('nav').each(function(a,b){if($.body[0].classList.contains('splitlayout'))return;if(b===0){a.classList.add('current')}else{a.classList.add('next')}});$('article').each(function(a,b){if($.body[0].classList.contains('splitlayout'))return;if($.body[0].classList.contains('slide-out-app')){return}if(b===0){a.classList.add('current')}else{a.classList.add('next')}});if(!$.body[0].classList.contains('splitlayout')){$.body.prepend("<nav id='global-nav'></nav>")}$.body.on('singletap','a.back',function(){if(this.classList.contains('back')){$.UIGoBack()}});$.body.on('singletap doubletap','li',function(){if($.isNavigating)return;if(!this.hasAttribute('data-goto'))return;if(!this.getAttribute('data-goto'))return;var a='#'+this.getAttribute('data-goto');var b=$(a);$.UIGoToArticle(b);$.UINavigationHistory.push(a)});if($('article').eq(1)[0]){$.UISetHashOnUrl($('article').eq(0)[0].id)}$('.segmented').UISegmented();$('.switch').UISwitch();$.body.on($.eventStart,'.cancel',function(){if($(this).ancestor('.popup')[0]){$(this).ancestor('.popup').UIPopupClose()}});window.onresize=function(){$.UICenterPopup();$.UIAlignPopover()};var c=$.eventStart+' singletap '+$.eventEnd;$.body.on(c,'.mask',function(e){if(!$('.popover')[0]){if(e&&e.nodeType===1)return;e.stopPropogation()}else{$.UIPopoverClose()}});if($.body[0].classList.contains('splitlayout')){if(window.innerWidth<768){$('meta[name=viewport]').attr('content','width=device-width, initial-scale=0.45, maximum-scale=2, user-scalable=yes')}}$('h1').each(function(a){if(a.nextElementSibling&&a.nextElementSibling.nodeName==='A'){a.classList.add('buttonOnRight')}});if($.isAndroid){$.body.addClass('isAndroid')}else if($.isiOS){$.body.addClass('isiOS')}else if($.isWin){$.body.addClass('isWindows')}$.UIDesktopCompat()})})(window.$chocolatechip);(function($){'use strict';var f={};var g;var h;var i;var j=750;var k=150;var l;function parentIfText(a){return'tagName'in a?a:a.parentNode}function swipeDirection(a,b,c,d){var e=Math.abs(a-b),yDelta=Math.abs(c-d);return e>=yDelta?(a-b>0?'left':'right'):(c-d>0?'up':'down')}function longTap(){l=null;if(f.last){try{f.el.trigger('longtap');f={}}catch(err){}}}function cancelLongTap(){if(l)clearTimeout(l);l=null}function cancelAll(){if(g)clearTimeout(g);if(i)clearTimeout(i);if(h)clearTimeout(h);if(l)clearTimeout(l);g=i=h=l=null;f={}}$(document).ready(function(){var a;var b;var c=$(document.body);var d=false;c.on($.eventStart,function(e){a=Date.now();b=a-(f.last||a);if(window.navigator.msPointerEnabled){if(!e.isPrimary)return;f.el=$(parentIfText(e.target));g&&clearTimeout(g);f.x1=e.pageX;f.y1=e.pageY;d=false}else{if($.eventStart==='mousedown'){f.el=$(parentIfText(e.target));g&&clearTimeout(g);f.x1=e.pageX;f.y1=e.pageY;d=false}else{if(e.touches.length===2){console.log('two fingers')}else if(e.touches.length===1){f.el=$(parentIfText(e.touches[0].target));g&&clearTimeout(g);f.x1=e.touches[0].pageX;f.y1=e.touches[0].pageY;if(e.targetTouches.length===2){d=true}else{d=false}}}}if(b>0&&b<=250){f.isDoubleTap=true}f.last=a;l=setTimeout(longTap,j)});c.on($.eventMove,function(e){if(window.navigator.msPointerEnabled){if(!e.isPrimary)return;cancelLongTap();f.x2=e.pageX;f.y2=e.pageY}else{cancelLongTap();if($.eventMove==='mousemove'){f.x2=e.pageX;f.y2=e.pageY}else{if(e.touches.length===1){f.x2=e.touches[0].pageX;f.y2=e.touches[0].pageY}}}});c.on($.eventEnd,function(e){if(window.navigator.msPointerEnabled){if(!e.isPrimary)return}cancelLongTap();if(!!f.el){if((f.x2&&Math.abs(f.x1-f.x2)>$.gestureLength)||(f.y2&&Math.abs(f.y1-f.y2)>$.gestureLength)){h=setTimeout(function(){f.el.trigger('swipe');f.el.trigger('swipe'+(swipeDirection(f.x1,f.x2,f.y1,f.y2)));f={}},0)}else if('last'in f){i=setTimeout(function(){f.el.trigger('tap');if(f.isDoubleTap){f.el.trigger('doubletap');f={}}else{g=setTimeout(function(){g=null;f.el.trigger('singletap');f={};return false},k)}},0)}}else{return}});c.on('touchcancel',cancelAll)});['swipe','swipeleft','swiperight','swipeup','swipedown','doubletap','tap','singletap','longtap'].forEach(function(m){$.extend(Array.prototype,{m:function(a){return this.on(m,a)}})})})(window.$chocolatechip);